create materialized view errorcolname as 
with sourceidentifiererrors as (
	select errorlevel,ac.acceptable_values->>'values' as value_expected,t2."SourceIdentifier" as value_in_csv from txnvalidations t1 left outer join tmp_txn_dump t2 on t1.csvrownumber+3=t2.id cross join acceptable_value_in_dump ac
	where errorlevel='1.1' and errorname='sourceidentifiererrors' and ac."column_name"='SourceIdentifier' group by errorlevel,value_expected,value_in_csv
),
sourcefilenameerrors as (
	select errorlevel,ac.acceptable_values->>'values' as value_expected,t2."SourceFileName" as value_in_csv from txnvalidations t1 left outer join tmp_txn_dump t2 on t1.csvrownumber+3=t2.id cross join acceptable_value_in_dump ac 
	where errorlevel='1.2' and errorname='sourcefilenameerrors' and ac."column_name"='SourceFileName' group by errorlevel,value_expected,value_in_csv
),
glaccountcodeerrors as (
	select errorlevel,ac.acceptable_values->>'values' as value_expected,t2."GLAccountCode" as value_in_csv from txnvalidations t1 left outer join tmp_txn_dump t2 on t1.csvrownumber+3=t2.id cross join acceptable_value_in_dump ac 
	where errorlevel='1.3' and errorname='glaccountcodeerrors'  and ac."column_name"='GLAccountCode' group by errorlevel,value_expected,value_in_csv
),
divisionerrors as (
	select errorlevel,ac.acceptable_values->>'values' as value_expected,t2."Division" as value_in_csv from txnvalidations t1 left outer join tmp_txn_dump t2 on t1.csvrownumber+3=t2.id cross join acceptable_value_in_dump ac 
	where errorlevel='1.4' and errorname='divisionerrors'  and ac."column_name"='Division' group by errorlevel,value_expected,value_in_csv
),
profitcentre1errors as (
	select errorlevel,ac.acceptable_values->>'values' as value_expected,t2."ProfitCentre1" as value_in_csv from txnvalidations t1 left outer join tmp_txn_dump t2 on t1.csvrownumber+3=t2.id cross join acceptable_value_in_dump ac 
	where errorlevel='1.5' and errorname='profitcentre1errors'  and ac."column_name"='ProfitCentre1' group by errorlevel,value_expected,value_in_csv
),
profitcentre2errors as (
	select errorlevel,ac.acceptable_values->>'values' as value_expected,t2."ProfitCentre1" as value_in_csv from txnvalidations t1 left outer join tmp_txn_dump t2 on t1.csvrownumber+3=t2.id cross join acceptable_value_in_dump ac 
	where errorlevel='1.5' and errorname='profitcentre2errors' and ac."column_name"='ProfitCentre2' group by errorlevel,value_expected,value_in_csv
),
ordertypeerrors as (
	select errorlevel,array_to_string(array_agg(distinct con.value),',') as value_expected,t2."OrderType" as value_in_csv from txnvalidations t1 left outer join tmp_txn_dump t2 on t1.csvrownumber+3=t2.id cross join config con 
	where errorlevel='2.1' and errorname='ordertypeerrors' and con."type"='order_type' group by errorlevel,value_in_csv
),
documenttypeerrors as (
	select errorlevel,ac.acceptable_values->>'values' as value_expected,t2."DocumentType" as value_in_csv from txnvalidations t1 left outer join tmp_txn_dump t2 on t1.csvrownumber+3=t2.id cross join acceptable_value_in_dump ac 
	where errorlevel='3.1' and errorname='documenttypeerrors' and ac."column_name"='DocumentType' group by errorlevel,value_expected,value_in_csv
),
plantcodeerrors as (
	select errorlevel,ac.acceptable_values->>'values' as value_expected,t2."PlantCode" as value_in_csv from txnvalidations t1 left outer join tmp_txn_dump t2 on t1.csvrownumber+3=t2.id cross join acceptable_value_in_dump ac 
	where errorlevel='2.2' and errorname='plantcodeerrors' and ac."column_name"='PlantCode' group by errorlevel,value_expected,value_in_csv
),
linenumbererrors as (
	select errorlevel,'4 digit number' as value_expected,t2."LineNumber" as value_in_csv from txnvalidations t1 left outer join tmp_txn_dump t2 on t1.csvrownumber+3=t2.id 
	where errorlevel='1.6' and errorname='linenumbererrors' group by errorlevel,value_expected,value_in_csv
),
UINorCompositionerrors as (
	select errorlevel,ac.acceptable_values->>'values' as value_expected,t2."UINorComposition" as value_in_csv from txnvalidations t1 left outer join tmp_txn_dump t2 on t1.csvrownumber+3=t2.id cross join acceptable_value_in_dump ac 
	where errorlevel='1.7' and errorname='uinorcompositionerrors' and ac."column_name"='UINorComposition' group by errorlevel,value_expected,value_in_csv
),
portcodeerrors as (
	select errorlevel,ac.acceptable_values->>'values' as value_expected,t2."PortCode" as value_in_csv from txnvalidations t1 left outer join tmp_txn_dump t2 on t1.csvrownumber+3=t2.id cross join acceptable_value_in_dump ac 
	where errorlevel='1.8' and errorname='portcodeerrors' and ac."column_name"='PortCode' group by errorlevel,value_expected,value_in_csv
),
shippingbillnumbererrors as (
	select errorlevel,ac.acceptable_values->>'values' as value_expected,t2."ShippingBillNumber" as value_in_csv from txnvalidations t1 left outer join tmp_txn_dump t2 on t1.csvrownumber+3=t2.id cross join acceptable_value_in_dump ac 
	where errorlevel='1.9' and errorname='shippingbillnumbererrors' and ac."column_name"='ShippingBillNumber' group by errorlevel,value_expected,value_in_csv
),
shippingbilldateerrors as (
	select errorlevel,ac.acceptable_values->>'values' as value_expected,t2."ShippingBillDate" as value_in_csv from txnvalidations t1 left outer join tmp_txn_dump t2 on t1.csvrownumber+3=t2.id cross join acceptable_value_in_dump ac 
	where errorlevel='1.10' and errorname='shippingbilldateerrors' and ac."column_name"='ShippingBillDate' group by errorlevel,value_expected,value_in_csv
),
foberrors as (
	select errorlevel,ac.acceptable_values->>'values' as value_expected,t2."FOB" as value_in_csv from txnvalidations t1 left outer join tmp_txn_dump t2 on t1.csvrownumber+3=t2.id cross join acceptable_value_in_dump ac 
	where errorlevel='1.11' and errorname='foberrors' and ac."column_name"='FOB' group by errorlevel,value_expected,value_in_csv
),
exportdutyerrors as (
	select errorlevel,ac.acceptable_values->>'values' as value_expected,t2."ExportDuty" as value_in_csv from txnvalidations t1 left outer join tmp_txn_dump t2 on t1.csvrownumber+3=t2.id cross join acceptable_value_in_dump ac 
	where errorlevel='1.12' and errorname='exportdutyerrors' and ac."column_name"='ExportDuty' group by errorlevel,value_expected,value_in_csv
),
tcsflagerrors as (
	select errorlevel,ac.acceptable_values->>'values' as value_expected,t2."TCSFlag" as value_in_csv from txnvalidations t1 left outer join tmp_txn_dump t2 on t1.csvrownumber+3=t2.id cross join acceptable_value_in_dump ac 
	where errorlevel='1.13' and errorname='tcsflagerrors' and ac."column_name"='TCSFlag' group by errorlevel,value_expected,value_in_csv
),
ecomgstinerrors as (
	select errorlevel,ac.acceptable_values->>'values' as value_expected,t2."eComGSTIN" as value_in_csv from txnvalidations t1 left outer join tmp_txn_dump t2 on t1.csvrownumber+3=t2.id cross join acceptable_value_in_dump ac 
	where errorlevel='1.14' and errorname='ecomgstinerrors' and ac."column_name"='eComGSTIN' group by errorlevel,value_expected,value_in_csv
),
itcflagerrors as (
	select errorlevel,ac.acceptable_values->>'values' as value_expected,t2."ITCFlag" as value_in_csv from txnvalidations t1 left outer join tmp_txn_dump t2 on t1.csvrownumber+3=t2.id cross join acceptable_value_in_dump ac 
	where errorlevel='1.15' and errorname='itcflagerrors' and ac."column_name"='ITCFlag' group by errorlevel,value_expected,value_in_csv
),
userdefinedfield1errors as (
	select errorlevel,'some value - cannot be null' as value_expected,t2."Userdefinedfield1" as value_in_csv from txnvalidations t1 left outer join tmp_txn_dump t2 on t1.csvrownumber+3=t2.id 
	where errorlevel='1.16' and errorname='userdefinedfield1errors' group by errorlevel,value_expected,value_in_csv
),
userdefinedfield2errors as (
	select errorlevel,'some value - cannot be null' as value_expected,t2."Userdefinedfield2" as value_in_csv from txnvalidations t1 left outer join tmp_txn_dump t2 on t1.csvrownumber+3=t2.id 
	where errorlevel='1.17' and errorname='userdefinedfield2errors' group by errorlevel,value_expected,value_in_csv
),
userdefinedfield3errors as (
	select errorlevel,'some value - cannot be null' as value_expected,t2."Userdefinedfield3" as value_in_csv from txnvalidations t1 left outer join tmp_txn_dump t2 on t1.csvrownumber+3=t2.id 
	where errorlevel='1.18' and errorname='userdefinedfield3errors' group by errorlevel,value_expected,value_in_csv
),
itemcategoryerrors as (
	select errorlevel,array_to_string(array_agg(distinct con.value),',') as value_expected,t2."ItemCategory" as value_in_csv from txnvalidations t1 left outer join tmp_txn_dump t2 on t1.csvrownumber+3=t2.id cross join config con 
	where errorlevel='2.3' and errorname='itemcategoryerrors' and con."type"='item_category' group by errorlevel,value_in_csv
),
returnperioderrors as (
	select errorlevel,t2."Period" as value_expected,t2."ReturnPeriod" as value_in_csv from txnvalidations t1 left outer join tmp_txn_dump t2 on t1.csvrownumber+3=t2.id
	where errorlevel='3.2' and errorname='returnperioderrors' group by errorlevel,value_expected,value_in_csv	
),
documentnumbererrors as (
	select errorlevel,'10 digit incremental' as value_expected,t2."DocumentNumber" as value_in_csv from txnvalidations t1 left outer join tmp_txn_dump t2 on t1.csvrownumber+3=t2.id 
	where errorlevel='1.19' and errorname='documentnumbererrors' group by errorlevel,value_expected,value_in_csv
),
accountingvouchernumbererrors as (
	select errorlevel,'8 digit incremental' as value_expected,t2."AccountingVoucherNumber" as value_in_csv from txnvalidations t1 left outer join tmp_txn_dump t2 on t1.csvrownumber+3=t2.id 
	where errorlevel='1.20' and errorname='accountingvouchernumbererrors' group by errorlevel,value_expected,value_in_csv
),
supplytypeerrors as (
	select errorlevel,'CAN,NIL,TAX'  as value_expected,t2."SupplyType" as value_in_csv from txnvalidations t1 left outer join tmp_txn_dump t2 on t1.csvrownumber+3=t2.id left outer join product_master pm on pm."product_code"::text=t2."CustomerCode"
	where errorname='supplytypeerrors' group by errorlevel,value_expected,value_in_csv
),
documentdateerrors as (
	select errorlevel,concat(substring(t2."ReturnPeriod"::text,3,6),'-',substring(cast(t2."ReturnPeriod" as text),1,2),'-xx')  as value_expected,t2."DocumentDate" as value_in_csv from txnvalidations t1 left outer join tmp_txn_dump t2 on t1.csvrownumber+3=t2.id
	where errorlevel='3.1' and errorname='documentdateerrors' group by errorlevel,value_expected,value_in_csv
),
crdrpregsterrors as (
	select errorlevel,ac.acceptable_values->>'values' as value_expected,t2."CRDRPreGST" as value_in_csv from txnvalidations t1 left outer join tmp_txn_dump t2 on t1.csvrownumber+3=t2.id cross join acceptable_value_in_dump ac
	where errorlevel='3.4' and errorname='crdrpregsterrors' group by errorlevel,value_expected,value_in_csv
),
reversechargeflagerrors as (
	select errorlevel,ac.acceptable_values->>'values' as value_expected,t2."ReverseChargeFlag" as value_in_csv from txnvalidations t1 left outer join tmp_txn_dump t2 on t1.csvrownumber+3=t2.id cross join acceptable_value_in_dump ac 
	where errorlevel='3.5' and errorname='reversechargeflagerrors' and ac."column_name"='ReverseChargeFlag' group by errorlevel,value_expected,value_in_csv
),
accountingvoucherdateerrors as (
	select errorlevel,concat(substring (t2."ReturnPeriod"::text,3,6),'-',substring(cast(t2."ReturnPeriod" as text),1,2),'-xx')  as value_expected,t2."AccountingVoucherDate" as value_in_csv from txnvalidations t1 left outer join tmp_txn_dump t2 on t1.csvrownumber+3=t2.id
	where errorlevel='3.6' and errorname='accountingvoucherdateerrors' group by errorlevel,value_expected,value_in_csv
),
billingtypeerrors as (
	select errorlevel,array_to_string(array_agg(distinct btr.type),',') as value_expected,t2."BillingType" as value_in_csv from txnvalidations t1 left outer join tmp_txn_dump t2 on t1.csvrownumber+3=t2.id cross join billing_type_rules btr
	where errorlevel='3.7' and errorname='billingtypeerrors' group by errorlevel,value_in_csv
),
subdivisionerrors as (
	select errorlevel,ac.acceptable_values->>'values' as value_expected,t2."SubDivision" as value_in_csv from txnvalidations t1 left outer join tmp_txn_dump t2 on t1.csvrownumber+3=t2.id cross join acceptable_value_in_dump ac 
	where errorlevel='2.5' and errorname='subdivisionerrors' and ac."column_name"='SubDivision' group by errorlevel,value_expected,value_in_csv
),
suppliergstinerrors as (
	select errorlevel,(select gstin from plant_gstin_master) as value_expected,t2."SupplierGSTIN" as value_in_csv from txnvalidations t1 left outer join tmp_txn_dump t2 on t1.csvrownumber+3=t2.id cross join plant_gstin_master 
	where errorlevel='2.6' and errorname='suppliergstinerrors' group by errorlevel,value_expected,value_in_csv
),
plantstateerrors as (
	select errorlevel,(select plant_master.state from plant_master left outer join tmp_txn_dump t2 on t2."PlantCode"=plant_master."plant_code") as value_expected,t2."PlantState" as value_in_csv from txnvalidations t1 left outer join tmp_txn_dump t2 on t1.csvrownumber+3=t2.id cross join plant_master 
	where errorlevel='2.7' and errorname='plantstateerrors' group by errorlevel,value_expected,value_in_csv
),
customercodeerrors as (
	select errorlevel,(select booth_code from booth_master left outer join tmp_txn_dump on booth_master.soldtoparty=tmp_txn_dump."SoldToParty" where tmp_txn_dump.id = t2.id) as value_expected,t2."CustomerCode" as value_in_csv from txnvalidations t1 left outer join tmp_txn_dump t2 on t1.csvrownumber+3=t2.id cross join booth_master 
	where errorlevel='1.21' and errorname='customercodeerrors' group by errorlevel,value_expected,value_in_csv
),
billtostateerrors as (
	select errorlevel,ac.acceptable_values->>'values' as value_expected,t2."BillToState" as value_in_csv from txnvalidations t1 left outer join tmp_txn_dump t2 on t1.csvrownumber+3=t2.id cross join acceptable_value_in_dump ac 
	where errorlevel='1.22' and errorname='billtostateerrors' and ac."column_name"='BillToState' group by errorlevel,value_expected,value_in_csv
),
shiptostateerrors as (
	select errorlevel,ac.acceptable_values->>'values' as value_expected,t2."ShipToState" as value_in_csv from txnvalidations t1 left outer join tmp_txn_dump t2 on t1.csvrownumber+3=t2.id cross join acceptable_value_in_dump ac 
	where errorlevel='1.23' and errorname='shiptostateerrors' and ac."column_name"='ShipToState' group by errorlevel,value_expected,value_in_csv
),
poserrors as (
	select errorlevel,ac.acceptable_values->>'values' as value_expected,t2."POS" as value_in_csv from txnvalidations t1 left outer join tmp_txn_dump t2 on t1.csvrownumber+3=t2.id cross join acceptable_value_in_dump ac 
	where errorlevel='1.24' and errorname='poserrors' and ac."column_name"='POS' group by errorlevel,value_expected,value_in_csv
),
soldtopartyerrors as (
	select errorlevel,(select soldtoparty from booth_master left outer join tmp_txn_dump on booth_master.booth_code=tmp_txn_dump."CustomerCode" where tmp_txn_dump.id=t2.id) as value_expected,t2."SoldToParty" as value_in_csv from txnvalidations t1 left outer join tmp_txn_dump t2 on t1.csvrownumber+3=t2.id 
	where errorlevel='1.25' and errorname='soldtopartyerrors' group by errorlevel,value_expected,value_in_csv
),
soldtopartynameerrors as (
	select errorlevel,(select soldtopartyname from booth_master left outer join tmp_txn_dump on booth_master.booth_code=tmp_txn_dump."CustomerCode" where tmp_txn_dump.id=t2.id) as value_expected,t2."SoldToPartyName" as value_in_csv from txnvalidations t1 left outer join tmp_txn_dump t2 on t1.csvrownumber+3=t2.id 
	where errorlevel='1.26' and errorname='soldtopartynameerrors' group by errorlevel,value_expected,value_in_csv
),

unitofmeasurementerrors as (
	select errorlevel,ac.acceptable_values->>'values' as value_expected,t2."UnitOfMeasurement" as value_in_csv from txnvalidations t1 left outer join tmp_txn_dump t2 on t1.csvrownumber+3=t2.id cross join acceptable_value_in_dump ac 
	where errorlevel='2.8' and errorname='unitofmeasurementerrors' and ac."column_name"='UnitOfMeasurement' group by errorlevel,value_expected,value_in_csv
),
quantityerrors as (
	select errorlevel,(select concat('should be multiple of ',lot_size) from product_master where product_master.id=t2.id) as value_expected,t2."SourceFileName" as value_in_csv from txnvalidations t1 left outer join tmp_txn_dump t2 on t1.csvrownumber+3=t2.id  
	where errorlevel='2.9' and errorname='quantityerrors' group by errorlevel,value_expected,value_in_csv
),
integratedtaxrateerrors as (
	select errorlevel,(select case when tmp_txn_dump."SaleLocalCentral"='Local' then 'NaN' else (select "GST" from tmp_txn_dump where tmp_txn_dump.id=t2.id) end from tmp_txn_dump where tmp_txn_dump.id=t2.id ) as value_expected,t2."IntegratedTaxRate" as value_in_csv from txnvalidations t1 left outer join tmp_txn_dump t2 on t1.csvrownumber+3=t2.id
	where errorlevel='3.8' and errorname='integratedtaxrateerrors' group by t1.errorlevel,value_expected,value_in_csv
),
integratedtaxamounterrors as (
	select errorlevel,(select round("TaxableValue"::numeric*(case when "IntegratedTaxRate"::text = 'NaN'::text then 0 else "IntegratedTaxRate"::numeric end)/100,3) from tmp_txn_dump inner join txnvalidations on tmp_txn_dump.id=txnvalidations.csvrownumber+3 where txnvalidations.errorname='integratedtaxamounterrors' and t2.id=tmp_txn_dump.id) as value_expected,t2."IntegratedTaxAmount" as value_in_csv from txnvalidations t1 left outer join tmp_txn_dump t2 on t1.csvrownumber+3=t2.id
	where errorlevel='3.9' and errorname='integratedtaxamounterrors' group by errorlevel,value_expected,value_in_csv,t2.id
),
centraltaxrateerrors as (
	select errorlevel,(select case when tmp_txn_dump."SaleLocalCentral"!='Local' then 'NaN' else (select ("GST"::numeric/2)::text from tmp_txn_dump where tmp_txn_dump.id=t2.id) end from tmp_txn_dump where tmp_txn_dump.id=t2.id ) as value_expected,t2."CentralTaxRate" as value_in_csv from txnvalidations t1 left outer join tmp_txn_dump t2 on t1.csvrownumber+3=t2.id
	where errorlevel='3.10' and errorname='centraltaxrateerrors' group by errorlevel,value_expected,value_in_csv
),
stateuttaxrateerrors as (
	select errorlevel,(select "CentralTaxRate" from tmp_txn_dump where tmp_txn_dump.id=t2.id) as value_expected,t2."StateUTTaxRate" as value_in_csv from txnvalidations t1 left outer join tmp_txn_dump t2 on t1.csvrownumber+3=t2.id
	where errorlevel='3.11' and errorname='stateuttaxrateerrors' group by errorlevel,value_expected,value_in_csv
),
stateuttaxamounterrors as (
	select errorlevel,(select "CentralTaxAmount" from tmp_txn_dump where tmp_txn_dump.id=t2.id) as value_expected,t2."StateUTTaxAmount" as value_in_csv from txnvalidations t1 left outer join tmp_txn_dump t2 on t1.csvrownumber+3=t2.id
	where errorlevel='3.12' and errorname='stateuttaxamounterrors' group by errorlevel,value_expected,value_in_csv
),
centraltaxamounterrors as (
	select errorlevel,(select round("TaxableValue"::numeric*(case when "CentralTaxRate"::text = 'NaN'::text then 0 else "CentralTaxRate"::numeric end)/100,3) from tmp_txn_dump inner join txnvalidations on tmp_txn_dump.id=txnvalidations.csvrownumber+3 where txnvalidations.errorname='centraltaxamounterrors' and t2.id=tmp_txn_dump.id) as value_expected,t2."CentralTaxAmount" as value_in_csv from txnvalidations t1 left outer join tmp_txn_dump t2 on t1.csvrownumber+3=t2.id
	where errorlevel='3.13' and errorname='centraltaxamounterrors' group by errorlevel,value_expected,value_in_csv,t2.id
),
customergstinerrors as (
	select errorlevel,(select gstin from booth_gstin_master left outer join tmp_txn_dump on booth_gstin_master.name=tmp_txn_dump."CustomerName" where tmp_txn_dump.id=t2.id) as value_expected,t2."CustomerGSTIN" as value_in_csv from txnvalidations t1 left outer join tmp_txn_dump t2 on t1.csvrownumber+3=t2.id 
	where errorlevel='3.14' and errorname='customergstinerrors' group by errorlevel,value_expected,value_in_csv
),
customernameerrors as (
	select errorlevel,(select name from booth_gstin_master left outer join tmp_txn_dump on booth_gstin_master.gstin=tmp_txn_dump."CustomerGSTIN" where tmp_txn_dump.id=t2.id) as value_expected,t2."CustomerName" as value_in_csv from txnvalidations t1 left outer join tmp_txn_dump t2 on t1.csvrownumber+3=t2.id 
	where errorlevel='1.27' and errorname='customernameerrors' group by errorlevel,value_expected,value_in_csv
),
productdescriptionerrors as (
	select errorlevel,(select description from product_master left outer join tmp_txn_dump on product_master.product_code::text=tmp_txn_dump."ProductCode" where tmp_txn_dump.id=t2.id) as value_expected,t2."ProductDescription" as value_in_csv from txnvalidations t1 left outer join tmp_txn_dump t2 on t1.csvrownumber+3=t2.id 
	where errorlevel='1.28' and errorname='productdescriptionerrors' group by errorlevel,value_expected,value_in_csv
),
taxablevalueerrors as (
	select errorlevel,(select concat('Between ',product_rates.purchase_price_min,' and ',product_rates.purchase_price_max) from product_rates left outer join product_master on product_rates."product_id"=product_master."id" left outer join tmp_txn_dump on tmp_txn_dump."ProductCode"=product_master.product_code::text where t2.id=tmp_txn_dump.id) as value_expected,t2."TaxableValue" as value_in_csv from txnvalidations t1 left outer join tmp_txn_dump t2 on t1.csvrownumber+3=t2.id 
	where errorlevel='1.29' and errorname='taxablevalueerrors' group by errorlevel,value_expected,value_in_csv
),
mrperrors as (
	select errorlevel,(select concat('Between ',product_rates.mrp_min,' and ',product_rates.mrp_max) from product_rates left outer join product_master on product_rates."product_id"=product_master."id" left outer join tmp_txn_dump on tmp_txn_dump."ProductCode"=product_master.product_code::text where t2.id=tmp_txn_dump.id) as value_expected,t2."MRP" as value_in_csv from txnvalidations t1 left outer join tmp_txn_dump t2 on t1.csvrownumber+3=t2.id 
	where errorlevel='1.30' and errorname='mrperrors' group by errorlevel,value_expected,value_in_csv
),
hsnorsacerrors as (
	select errorlevel,(select hsn_code::text from product_master left outer join tmp_txn_dump on product_master.product_code::text=tmp_txn_dump."ProductCode" where tmp_txn_dump.id=t2.id) as value_expected,t2."HSNorSAC" as value_in_csv from txnvalidations t1 left outer join tmp_txn_dump t2 on t1.csvrownumber+3=t2.id 
	where errorlevel='2.10' and errorname='hsnorsacerrors' group by errorlevel,value_expected,value_in_csv
),
productcodeerrors as (
	select errorlevel,(select Product_code::text from product_master left outer join tmp_txn_dump on product_master.description::text=tmp_txn_dump."ProductDescription" where tmp_txn_dump.id=t2.id) as value_expected,t2."ProductCode" as value_in_csv from txnvalidations t1 left outer join tmp_txn_dump t2 on t1.csvrownumber+3=t2.id 
	where errorlevel='2.11' and errorname='productcodeerrors' group by errorlevel,value_expected,value_in_csv
),
cessrateadvaloremerrors as (
	select errorlevel,ac.acceptable_values->>'values' as value_expected,t2."CessRateAdvalorem" as value_in_csv from txnvalidations t1 left outer join tmp_txn_dump t2 on t1.csvrownumber+3=t2.id cross join acceptable_value_in_dump ac 
	where errorlevel='3.15' and errorname='cessrateadvaloremerrors'  and ac."column_name"='CessRateAdvalorem' group by errorlevel,value_expected,value_in_csv
),
cessamountadvaloremerrors as (
	select errorlevel,ac.acceptable_values->>'values' as value_expected,t2."CessAmountAdvalorem" as value_in_csv from txnvalidations t1 left outer join tmp_txn_dump t2 on t1.csvrownumber+3=t2.id cross join acceptable_value_in_dump ac 
	where errorlevel='3.16' and errorname='cessamountadvaloremerrors'  and ac."column_name"='CessAmountAdvalorem' group by errorlevel,value_expected,value_in_csv
),
cessratespecificerrors as (
	select errorlevel,ac.acceptable_values->>'values' as value_expected,t2."CessRateSpecific" as value_in_csv from txnvalidations t1 left outer join tmp_txn_dump t2 on t1.csvrownumber+3=t2.id cross join acceptable_value_in_dump ac 
	where errorlevel='3.17' and errorname='cessratespecificerrors'  and ac."column_name"='CessRateSpecific' group by errorlevel,value_expected,value_in_csv
),
cessamountspecificerrors as (
	select errorlevel,ac.acceptable_values->>'values' as value_expected,t2."CessAmountSpecific" as value_in_csv from txnvalidations t1 left outer join tmp_txn_dump t2 on t1.csvrownumber+3=t2.id cross join acceptable_value_in_dump ac 
	where errorlevel='3.18' and errorname='cessamountspecificerrors'  and ac."column_name"='CessAmountSpecific' group by errorlevel,value_expected,value_in_csv
),
invoicevalueerrors as (
	select errorlevel,(select (sum("TaxableValue"::numeric)+sum("TotalGSTValue"::numeric))::text from tmp_txn_dump where tmp_txn_dump."DocumentNumber"=t1.invoicenumber group by "InvoiceValue") as value_expected,t2."InvoiceValue" as value_in_csv from txnvalidations t1 left outer join tmp_txn_dump t2 on t1.csvrownumber+3=t2.id
	where errorlevel='3.19' and errorname='invoicevalueerrors' group by errorlevel,value_expected,value_in_csv
),
salelocalcentralerrors as (
	select errorlevel,(select case when tmp_txn_dump."POS"=substring(tmp_txn_dump."SupplierGSTIN",1,2) then 'Local' else 'Central' end from tmp_txn_dump where tmp_txn_dump.id=t2.id) as value_expected,t2."SaleLocalCentral" as value_in_csv from txnvalidations t1 left outer join tmp_txn_dump t2 on t1.csvrownumber+3=t2.id
	where errorlevel='3.20' and errorname='salelocalcentralerrors' group by errorlevel,value_expected,value_in_csv
),
gsterrors as (
	select errorlevel,(select ((case when tmp_txn_dump."CentralTaxRate"='NaN' then 0 else tmp_txn_dump."CentralTaxRate"::numeric end)+(case when tmp_txn_dump."StateUTTaxRate"='NaN' then 0 else tmp_txn_dump."StateUTTaxRate"::numeric end)+(case when tmp_txn_dump."IntegratedTaxRate"='NaN' then 0 else tmp_txn_dump."IntegratedTaxRate"::numeric end))::text from tmp_txn_dump where t2.id=tmp_txn_dump.id) as value_expected,t2."GST" as value_in_csv from txnvalidations t1 left outer join tmp_txn_dump t2 on t1.csvrownumber+3=t2.id
	where (errorlevel='3.21' or errorlevel='2.12') and errorname='gsterrors' group by errorlevel,value_expected,value_in_csv,t2.id
),
totalgstvalueerrors as (
	select errorlevel,(select ((case when tmp_txn_dump."CentralTaxAmount"='NaN' then 0 else tmp_txn_dump."CentralTaxAmount"::numeric end)+(case when tmp_txn_dump."StateUTTaxAmount"='NaN' then 0 else tmp_txn_dump."StateUTTaxAmount"::numeric end)+(case when tmp_txn_dump."IntegratedTaxAmount"='NaN' then 0 else tmp_txn_dump."IntegratedTaxAmount"::numeric end))::text from tmp_txn_dump where t2.id=tmp_txn_dump.id) as value_expected,t2."TotalGSTValue" as value_in_csv from txnvalidations t1 left outer join tmp_txn_dump t2 on t1.csvrownumber+3=t2.id
	where errorlevel='3.22' and errorname='totalgstvalueerrors' group by errorlevel,value_expected,value_in_csv,t2.id
),
originaldocumentnumbererrors as (
	select errorlevel,(select case when "SupplyType"='CR' then 'Invoice Reference' else 'NaN' end from tmp_txn_dump where tmp_txn_dump.id=t2.id) as value_expected,t2."OriginalDocumentNumber" as value_in_csv from txnvalidations t1 left outer join tmp_txn_dump t2 on t1.csvrownumber+3=t2.id
	where errorlevel='3.23' and errorname='originaldocumentnumbererrors' group by errorlevel,value_expected,value_in_csv,t2.id
),
originaldocumentdateerrors as (
	select errorlevel,(select case when "OriginalDocumentNumber"<>'NaN' then 'Match with invoice details' else 'NaN' end from tmp_txn_dump where tmp_txn_dump.id=t2.id) as value_expected,t2."OriginalDocumentDate" as value_in_csv from txnvalidations t1 left outer join tmp_txn_dump t2 on t1.csvrownumber+3=t2.id
	where errorlevel='3.24' and errorname='originaldocumentdateerrors' group by errorlevel,value_expected,value_in_csv
)

select * from sourceidentifiererrors
union
select * from sourcefilenameerrors
union
select * from glaccountcodeerrors
union
select * from divisionerrors
union
select * from profitcentre1errors
union
select * from profitcentre2errors
union
select * from ordertypeerrors
union
select * from documenttypeerrors
union
select * from plantcodeerrors
union
select * from soldtopartyerrors
union
select * from linenumbererrors
union
select * from uinorcompositionerrors
union
select * from portcodeerrors
union
select * from shippingbillnumbererrors
union
select * from shippingbilldateerrors
union
select * from foberrors
union
select * from exportdutyerrors
union
select * from tcsflagerrors
union
select * from ecomgstinerrors
union
select * from itcflagerrors
union
select * from userdefinedfield1errors
union
select * from userdefinedfield2errors
union
select * from userdefinedfield3errors
union
select * from itemcategoryerrors
union
select * from returnperioderrors
union
select * from documentnumbererrors
union
select * from accountingvouchernumbererrors
union
select * from supplytypeerrors
union
select * from documentdateerrors
union
select * from crdrpregsterrors
union
select * from reversechargeflagerrors
union
select * from accountingvoucherdateerrors
union
select * from billingtypeerrors
union
select * from subdivisionerrors
union
select * from suppliergstinerrors
union
select * from plantstateerrors
union
select * from billtostateerrors
union
select * from shiptostateerrors
union
select * from poserrors
union
select * from unitofmeasurementerrors
union
select * from integratedtaxrateerrors
union
select * from soldtopartynameerrors
union
select * from customergstinerrors
union
select * from productdescriptionerrors
union
select * from taxablevalueerrors
union
select * from mrperrors
union
select * from hsnorsacerrors
union
select * from productcodeerrors
union
select * from centraltaxrateerrors
union
select * from stateuttaxrateerrors
union
select * from stateuttaxamounterrors
union
select * from cessrateadvaloremerrors
union
select * from cessamountadvaloremerrors
union
select * from cessratespecificerrors
union
select * from cessamountspecificerrors
union
select * from salelocalcentralerrors
union
select * from gsterrors
union
select * from totalgstvalueerrors
union
select * from originaldocumentnumbererrors
union
select * from originaldocumentdateerrors
union
select * from quantityerrors
union
select * from invoicevalueerrors
union
select * from customercodeerrors		
